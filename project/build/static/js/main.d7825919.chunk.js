(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{67:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return Le}));var c,n=a(1),i=a.n(n),r=a(21),s=a.n(r),l=a(37),o=a.n(l),d="T2xpdmVyLmNvbm5lckBnbWFpbC5jb20=",u=function(e){localStorage.setItem(d,e)};!function(e){e[e.Unauthorized=401]="Unauthorized"}(c||(c={}));var j,m,b,h=a(2),f=a(7),_=a(5),v=a(6);!function(e){e.Root="/",e.MyList="/mylist",e.MoviePage="/films/:movieId",e.AddReview="/films/:movieId/review",e.Player="/player/:movieId",e.SignIn="/login"}(j||(j={})),function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(m||(m={})),function(e){e.Films="/films",e.Comments="/comments",e.MyFilms="/favorite",e.Promo="/promo",e.Login="/login",e.Logout="/logout"}(b||(b={}));var O=a(24),x=a(8),p=a(0);var g=function(){return Object(p.jsxs)("footer",{className:"page-footer",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsxs)(_.b,{className:"logo__link logo__link--light",to:"/",children:[Object(p.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})}),Object(p.jsx)("div",{className:"copyright",children:Object(p.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})};var N=function(e){var t=e.film;return Object(p.jsxs)("video",{width:"280",height:"175",autoPlay:!0,muted:!0,children:[Object(p.jsx)("source",{src:t.preview_video_link,type:'video/webm; codecs="vp8, vorbis"'}),Object(p.jsx)("source",{src:t.preview_video_link,type:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'})]})};var w=function(e){var t,a=e.film,c=e.isSimilarFilm,i=Object(n.useState)(Boolean),r=Object(x.a)(i,2),s=r[0],l=r[1];function o(){clearTimeout(t),l(!1)}var d=Object(v.g)();return Object(p.jsxs)("article",{className:"small-film-card catalog__films-card",onMouseOver:function(){t=setTimeout((function(){return l(!0)}),1e3)},onMouseOut:o,onClick:function(){o(),d.push("".concat(c?"":"films/").concat(a.id))},children:[Object(p.jsx)("div",{className:"small-film-card__image",children:s?Object(p.jsx)(N,{film:a}):Object(p.jsx)("img",{src:a.preview_image,alt:a.name,width:"280",height:"175"})}),Object(p.jsx)("h3",{className:"small-film-card__title",children:Object(p.jsx)(_.b,{className:"small-film-card__link",to:"".concat(a.id),onClick:o,children:a.name})})]})};var y=function(e){var t=e.films,a=e.isSimilarFilm;return Object(p.jsx)("div",{className:"catalog__films-list",children:t.map((function(e){return Object(p.jsx)(w,{isSimilarFilm:a,film:e},e.id)}))})};var k,S=function(e){var t=e.films,a=e.genre,c=e.onUserClick,n=t.map((function(e){return e.genre})),i=Object(O.a)(new Set(n));function r(e){e.preventDefault(),c(e.target.textContent)}return Object(p.jsxs)("ul",{className:"catalog__genres-list",children:[Object(p.jsx)("li",{className:"catalog__genres-item ".concat("All genres"===a?"catalog__genres-item--active":""),onClick:r,children:Object(p.jsx)("a",{href:"/",className:"catalog__genres-link",children:"All genres"})}),i.map((function(e){return Object(p.jsx)("li",{className:"catalog__genres-item ".concat(e===a?"catalog__genres-item--active":""),onClick:r,children:Object(p.jsx)("a",{href:"/",className:"catalog__genres-link",children:e})},e)}))]})};!function(e){e.ChangeGenre="films/changeGenre",e.LoadFilms="films/loadFilms",e.LoadCurrentFilm="films/loadCurrentFilm",e.LoadPromoFilm="films/loadPromoFilm",e.LoadSimilarFilms="films/loadSimilarFilms",e.LoadMyFilms="films/loadMyFilms",e.LoadComments="comments/loadComments",e.ShowMoreFilms="data/showMoreFilms",e.RequireAuthorization="user/requireAuthorization",e.RequireLogout="user/requireLogout",e.UserAuthorization="user/userAuthorization",e.SaveUserAvatarUrl="user/saveUserAvatarUrl"}(k||(k={}));var C=Object(f.b)(k.ChangeGenre,(function(e){return{payload:e}})),F=Object(f.b)(k.LoadFilms,(function(e){return{payload:e}})),L=Object(f.b)(k.LoadMyFilms,(function(e){return{payload:e}})),A=Object(f.b)(k.LoadCurrentFilm,(function(e){return{payload:e}})),M=Object(f.b)(k.LoadPromoFilm,(function(e){return{payload:e}})),T=Object(f.b)(k.LoadSimilarFilms,(function(e){return{payload:e}})),U=Object(f.b)(k.LoadComments,(function(e){return{payload:e}})),I=Object(f.b)(k.RequireAuthorization,(function(e){return{payload:e}})),R=Object(f.b)(k.SaveUserAvatarUrl,(function(e){return{payload:e}})),D=Object(f.b)(k.RequireLogout);var P=function(e){var t=e.onShowMoreClick;return Object(p.jsx)("div",{className:"catalog__more",children:Object(p.jsx)("button",{className:"catalog__button",type:"button",onClick:t,children:"Show more"})})};var z,B,W=function(){return Object(p.jsxs)(_.b,{className:"logo__link",to:"/",children:[Object(p.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})},q=a(17),E=a(11),G=Object(f.c)({films:[],similarFilms:[],myFilms:[],promoFilm:{id:0,name:"",poster_image:"",preview_image:"",background_image:"",background_color:"",video_link:"",preview_video_link:"",description:"",rating:0,scores_count:0,director:"",starring:[],run_time:0,genre:"",released:0,is_favorite:!1},currentFilm:{id:0,name:"",poster_image:"",preview_image:"",background_image:"",background_color:"",video_link:"",preview_video_link:"",description:"",rating:0,scores_count:0,director:"",starring:[],run_time:0,genre:"",released:0,is_favorite:!1}},(function(e){e.addCase(F,(function(e,t){e.films=t.payload})).addCase(A,(function(e,t){e.currentFilm=t.payload})).addCase(T,(function(e,t){e.similarFilms=t.payload})).addCase(M,(function(e,t){e.promoFilm=t.payload})).addCase(L,(function(e,t){e.myFilms=t.payload}))})),V=Object(f.c)({genre:"All genres",comments:[]},(function(e){e.addCase(C,(function(e,t){e.genre=t.payload})).addCase(U,(function(e,t){e.comments=t.payload}))})),H={authorizationStatus:m.Unknown,isDataLoaded:!1,userAvatarUrl:""},J=Object(f.c)(H,(function(e){e.addCase(R,(function(e,t){e.userAvatarUrl=t.payload})).addCase(I,(function(e,t){e.authorizationStatus=t.payload,e.isDataLoaded=!0})).addCase(D,(function(e){e.authorizationStatus=m.NoAuth}))}));!function(e){e.films="FILMS",e.filmsOther="FILMS_OTHER",e.user="USER"}(B||(B={}));var Z=Object(E.c)((z={},Object(q.a)(z,B.films,G),Object(q.a)(z,B.filmsOther,V),Object(q.a)(z,B.user,J),z)),K=function(e){return e[B.user].authorizationStatus},Q=function(e){return e[B.user].isDataLoaded},X=function(e){return e[B.user].userAvatarUrl},Y=a(4),$=a.n(Y),ee=a(15),te=function(e){return function(){var t=Object(ee.a)($.a.mark((function t(a,c,n){var i,r;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get("".concat(b.Films,"/").concat(e));case 2:i=t.sent,r=i.data,a(A(r));case 5:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()},ae=function(){return function(){var e=Object(ee.a)($.a.mark((function e(t,a,c){var n,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(b.Promo);case 2:n=e.sent,i=n.data,t(M(i));case 5:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()},ce=function(){return function(){var e=Object(ee.a)($.a.mark((function e(t,a,c){var n,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(b.MyFilms);case 2:n=e.sent,i=n.data,t(L(i));case 5:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()},ne=function(e,t){return function(){var a=Object(ee.a)($.a.mark((function a(c,n,i){var r,s;return $.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.post("".concat(b.MyFilms,"/").concat(e,"/").concat(t));case 2:r=a.sent,s=r.data,c(A(s));case 5:case"end":return a.stop()}}),a)})));return function(e,t,c){return a.apply(this,arguments)}}()};var ie=function(e){var t=e.authorizationStatus,a=Object(h.b)();return t===m.Auth?Object(p.jsx)("a",{className:"user-block__link",href:"/",onClick:function(e){e.preventDefault(),a(function(){var e=Object(ee.a)($.a.mark((function e(t,a,c){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.delete(b.Logout),localStorage.removeItem(d),t(D());case 3:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}())},children:"Sign Out"}):Object(p.jsx)(_.b,{className:"user-block__link",to:j.SignIn,children:"Sign in"})};var re=function(e){var t=e.isMyList,a=e.isSignIn,c=e.headerTitle,n=Object(h.c)(K),i=Object(h.c)(X),r=Object(v.g)(),s=Object(h.b)();return Object(p.jsxs)("header",{className:"page-header ".concat(c),children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(W,{})}),t?Object(p.jsx)("h1",{className:"page-title user-page__title",children:"My list"}):"",a?Object(p.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"}):"",a?"":Object(p.jsxs)("ul",{className:"user-block",children:[Object(p.jsx)("li",{className:"user-block__item",children:Object(p.jsx)("div",{className:"user-block__avatar",onClick:function(){s(ce()),r.push(j.MyList)},children:Object(p.jsx)("img",{src:n===m.Auth?i:"img/avatar.jpg",alt:"User avatar",width:"63",height:"63"})})}),Object(p.jsx)("li",{className:"user-block__item",children:Object(p.jsx)(ie,{authorizationStatus:n})})]})]})},se=function(e){return e[B.films].films},le=function(e){return e[B.films].similarFilms},oe=function(e){return e[B.films].currentFilm},de=function(e){return e[B.films].promoFilm},ue=function(e){return e[B.films].myFilms},je=function(e){return e[B.filmsOther].genre},me=function(e){return e[B.filmsOther].comments};var be=function(){var e=Object(h.c)(se),t=Object(h.c)(je),a=Object(h.c)(de),c=Object(h.b)(),i=Object(n.useState)(8),r=Object(x.a)(i,2),s=r[0],l=r[1],o=Object(v.g)(),d=Object(n.useState)(e),u=Object(x.a)(d,2),j=u[0],m=u[1];return Object(n.useEffect)((function(){var a="All genres"===t?Object(O.a)(e):e.filter((function(e){return e.genre===t}));s<a.length?m(a.slice(0,s)):m(a)}),[t,s,e]),Object(p.jsxs)("div",{children:[Object(p.jsxs)("section",{className:"film-card",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:"img/bg-the-grand-budapest-hotel.jpg",alt:"The Grand Budapest Hotel"})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsx)(re,{isMyList:!1,isSignIn:!1,headerTitle:"film-card__head"}),!!e.length&&Object(p.jsx)("div",{className:"film-card__wrap",children:Object(p.jsxs)("div",{className:"film-card__info",children:[Object(p.jsx)("div",{className:"film-card__poster",children:Object(p.jsx)("img",{src:a.poster_image,alt:a.name,width:"218",height:"327"})}),Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("h2",{className:"film-card__title",children:a.name}),Object(p.jsxs)("p",{className:"film-card__meta",children:[Object(p.jsx)("span",{className:"film-card__genre",children:a.genre}),Object(p.jsx)("span",{className:"film-card__year",children:a.released})]}),Object(p.jsxs)("div",{className:"film-card__buttons",children:[Object(p.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return o.push("/player/".concat(a.id))},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(p.jsx)("use",{href:"#play-s"})}),Object(p.jsx)("span",{children:"Play"})]}),Object(p.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(e){var t,n;e.preventDefault(),t=String(a.id),n=Number(a.is_favorite),c(ne(t,Number(!n))),c(ae()),c(ce())},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(p.jsx)("use",{href:"#".concat(a.is_favorite?"in-list":"add")})}),Object(p.jsx)("span",{children:"My list"})]})]})]})]})})]}),Object(p.jsxs)("div",{className:"page-content",children:[Object(p.jsxs)("section",{className:"catalog",children:[Object(p.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(p.jsx)(S,{films:e,genre:t,onUserClick:function(e){c(C(e))}}),Object(p.jsx)(y,{films:j,isSimilarFilm:!1}),s<=j.length&&Object(p.jsx)(P,{onShowMoreClick:function(){l(s+8)}})]}),Object(p.jsx)(g,{})]})]})},he=a(20);var fe=function(e){var t=e.handleClose;return Object(p.jsxs)(i.a.Fragment,{children:[Object(p.jsx)("h1",{children:"\u041e\u0448\u0438\u0431\u043a\u0430! \u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a."}),Object(p.jsx)("button",{onClick:t,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})};var _e=function(){var e=Object(h.c)(se),t=Object(h.b)(),a=function(e,a){var c=a.rating,n=a.comment;N(!0),S(!0),t(function(e,t,a,c){var n=t.rating,i=t.comment;return function(){var t=Object(ee.a)($.a.mark((function t(r,s,l){var o,d;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.post("".concat(b.Comments,"/").concat(e),{rating:n,comment:i});case 3:o=t.sent,d=o.data,r(U(d)),a(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),c();case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a,c){return t.apply(this,arguments)}}()}(e,{rating:c,comment:n},F,L))},c=Object(n.useState)(!1),r=Object(x.a)(c,2),s=r[0],l=r[1],o=Object(v.h)().movieId,d=e.find((function(e){return e.id===parseInt(o,10)})),u=Object(n.useState)({rating:0,comment:""}),j=Object(x.a)(u,2),m=j[0],f=j[1],_=Object(n.useState)(!0),O=Object(x.a)(_,2),g=O[0],N=O[1],w=Object(n.useState)(Boolean),y=Object(x.a)(w,2),k=y[0],S=y[1],C=Object(v.g)(),F=function(){N(!1),S(!1),l(!1),C.push("/films/".concat(o))},L=function(){l(!0),N(!1),S(!1)};return Object(p.jsxs)(i.a.Fragment,{children:[s?Object(p.jsx)(fe,{handleClose:function(){l(!1)}}):"",Object(p.jsxs)("section",{className:"film-card film-card--full",children:[Object(p.jsxs)("div",{className:"film-card__header",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:null===d||void 0===d?void 0:d.background_image,alt:null===d||void 0===d?void 0:d.name})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsx)(re,{isMyList:!1,isSignIn:!1,headerTitle:"film-card__head"}),Object(p.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(p.jsx)("img",{src:null===d||void 0===d?void 0:d.poster_image,alt:null===d||void 0===d?void 0:d.name,width:"218",height:"327"})})]}),Object(p.jsx)("div",{className:"add-review",children:Object(p.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),a(o,{rating:m.rating,comment:m.comment})},children:[Object(p.jsx)("div",{className:"rating",children:Object(p.jsx)("div",{className:"rating__stars",children:[10,9,8,7,6,5,4,3,2,1].map((function(e){return Object(p.jsxs)(i.a.Fragment,{children:[Object(p.jsx)("input",{onClick:function(){return t=e,f((function(e){return Object(he.a)(Object(he.a)({},e),{},{rating:t})})),void(m.comment.length<50||m.comment.length>400||0===t?N(!0):N(!1));var t},className:"rating__input",id:"star-".concat(e),type:"radio",name:"rating",value:e,disabled:k}),Object(p.jsx)("label",{className:"rating__label",htmlFor:"star-".concat(e),children:"Rating ".concat(e)})]},e)}))})}),Object(p.jsxs)("div",{className:"add-review__text",children:[Object(p.jsx)("textarea",{className:"add-review__textarea",name:"review-text",id:"review-text",placeholder:"Review text",onChange:function(e){return function(e){e.preventDefault(),f((function(t){return Object(he.a)(Object(he.a)({},t),{},{comment:e.target.value})})),m.comment.length<50||m.comment.length>400||0===m.rating?N(!0):N(!1)}(e)},maxLength:400,minLength:50,disabled:k}),Object(p.jsx)("div",{className:"add-review__submit",children:Object(p.jsx)("button",{className:"add-review__btn",type:"submit",disabled:g,children:"Post"})})]})]})})]})]})};var ve=function(e){var t=e.film;return Object(p.jsxs)(n.Fragment,{children:[Object(p.jsxs)("div",{className:"film-rating",children:[Object(p.jsx)("div",{className:"film-rating__score",children:null===t||void 0===t?void 0:t.rating}),Object(p.jsxs)("p",{className:"film-rating__meta",children:[Object(p.jsx)("span",{className:"film-rating__level",children:function(e){if(void 0!==e){if(e>0&&e<3)return"Bad";if(e>=3&&e<5)return"Normal";if(e>=5&&e<8)return"Good";if(e>=8&&e<10)return"Very Good";if(10===e)return"Awesome"}}(null===t||void 0===t?void 0:t.rating)}),Object(p.jsx)("span",{className:"film-rating__count",children:null===t||void 0===t?void 0:t.scores_count})]})]}),Object(p.jsxs)("div",{className:"film-card__text",children:[Object(p.jsx)("p",{children:null===t||void 0===t?void 0:t.description}),Object(p.jsx)("p",{className:"film-card__director",children:Object(p.jsxs)("strong",{children:["Director: ",null===t||void 0===t?void 0:t.director]})}),Object(p.jsx)("p",{className:"film-card__starring",children:Object(p.jsxs)("strong",{children:["Starring: ",null===t||void 0===t?void 0:t.starring.join(", ")]})})]})]})};var Oe=function(e){var t=e.film;return Object(p.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(p.jsxs)("div",{className:"film-card__text-col",children:[Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(p.jsx)("span",{className:"film-card__details-value",children:null===t||void 0===t?void 0:t.director})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(p.jsx)("span",{className:"film-card__details-value",children:null===t||void 0===t?void 0:t.starring.join("\n")})]})]}),Object(p.jsxs)("div",{className:"film-card__text-col",children:[Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(p.jsx)("span",{className:"film-card__details-value",children:null===t||void 0===t?void 0:t.run_time})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(p.jsx)("span",{className:"film-card__details-value",children:null===t||void 0===t?void 0:t.genre})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(p.jsx)("span",{className:"film-card__details-value",children:null===t||void 0===t?void 0:t.released})]})]})]})};var xe=function(e){var t=e.comments,a=[],c=[];if(t.length){var n=Math.ceil(t.length/2);a=t.slice(0,n),c=t.slice(n,t.length)}return Object(p.jsxs)("div",{className:"film-card__reviews film-card__row",children:[Object(p.jsx)("div",{className:"film-card__reviews-col",children:a.map((function(e){return Object(p.jsxs)("div",{className:"review",children:[Object(p.jsxs)("blockquote",{className:"review__quote",children:[Object(p.jsx)("p",{className:"review__text",children:e.comment}),Object(p.jsxs)("footer",{className:"review__details",children:[Object(p.jsx)("cite",{className:"review__author",children:e.user.name}),Object(p.jsx)("time",{className:"review__date",dateTime:new Date(e.date).toLocaleString("en-US",{day:"numeric",year:"numeric",month:"long"}),children:new Date(e.date).toLocaleString("en-US",{day:"numeric",year:"numeric",month:"long"})})]})]}),Object(p.jsx)("div",{className:"review__rating",children:e.rating})]},e.id)}))}),Object(p.jsx)("div",{className:"film-card__reviews-col",children:c.map((function(e){return Object(p.jsxs)("div",{className:"review",children:[Object(p.jsxs)("blockquote",{className:"review__quote",children:[Object(p.jsx)("p",{className:"review__text",children:e.comment}),Object(p.jsxs)("footer",{className:"review__details",children:[Object(p.jsx)("cite",{className:"review__author",children:e.user.name}),Object(p.jsx)("time",{className:"review__date",dateTime:"2016-12-24",children:"December 24, 2016"})]})]}),Object(p.jsx)("div",{className:"review__rating",children:e.rating})]},e.id)}))})]})};var pe=function(){var e=Object(h.c)(oe),t=Object(h.c)(K),a=Object(h.c)(me),c=Object(h.c)(le),i=Object(v.g)(),r=Object(h.b)(),s=function(e,t){r(ne(e,t)),r(te(e)),r(ce())},l=Object(v.h)().movieId,o=Object(n.useState)("Overview"),d=Object(x.a)(o,2),u=d[0],j=d[1];Object(n.useEffect)((function(){Le.dispatch(function(e){return function(){var t=Object(ee.a)($.a.mark((function t(a,c,n){var i,r;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get("".concat(b.Comments,"/").concat(e));case 2:i=t.sent,r=i.data,a(U(r));case 5:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()}(l)),Le.dispatch(function(e){return function(){var t=Object(ee.a)($.a.mark((function t(a,c,n){var i,r;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get("".concat(b.Films,"/").concat(e,"/similar"));case 2:i=t.sent,r=i.data,a(T(r));case 5:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()}(l)),Le.dispatch(te(l))}),[l]);var f=Object(n.useCallback)((function(e){e.preventDefault(),j(e.currentTarget.innerText)}),[]);return Object(p.jsxs)("div",{children:[Object(p.jsxs)("section",{className:"film-card film-card--full",children:[Object(p.jsxs)("div",{className:"film-card__hero",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:e.background_image,alt:e.name})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsx)(re,{isMyList:!1,isSignIn:!1,headerTitle:"film-card__head"}),Object(p.jsx)("div",{className:"film-card__wrap",children:Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("h2",{className:"film-card__title",children:e.name}),Object(p.jsxs)("p",{className:"film-card__meta",children:[Object(p.jsx)("span",{className:"film-card__genre",children:e.genre}),Object(p.jsx)("span",{className:"film-card__year",children:e.released})]}),Object(p.jsxs)("div",{className:"film-card__buttons",children:[Object(p.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return i.push("/player/".concat(e.id))},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(p.jsx)("use",{href:"#play-s"})}),Object(p.jsx)("span",{children:"Play"})]}),Object(p.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(t){t.preventDefault(),e.is_favorite?s(l,0):s(l,1)},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(p.jsx)("use",{href:"#".concat(e.is_favorite?"in-list":"add")})}),Object(p.jsx)("span",{children:"My list"})]}),t===m.Auth?Object(p.jsx)(_.b,{className:"btn film-card__button",to:"/films/".concat(e.id,"/review"),children:"Add review"}):""]})]})})]}),Object(p.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(p.jsxs)("div",{className:"film-card__info",children:[Object(p.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(p.jsx)("img",{src:e.poster_image,alt:e.name,width:"218",height:"327"})}),Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("nav",{className:"film-nav film-card__nav",children:Object(p.jsxs)("ul",{className:"film-nav__list",children:[Object(p.jsx)("li",{className:"film-nav__item".concat("Overview"===u?" film-nav__item--active":""),children:Object(p.jsx)("a",{href:"/",className:"film-nav__link",onClick:f,children:"Overview"})}),Object(p.jsx)("li",{className:"film-nav__item".concat("Details"===u?" film-nav__item--active":""),children:Object(p.jsx)("a",{href:"/",className:"film-nav__link",onClick:f,children:"Details"})}),Object(p.jsx)("li",{className:"film-nav__item".concat("Reviews"===u?" film-nav__item--active":""),children:Object(p.jsx)("a",{href:"/",className:"film-nav__link",onClick:f,children:"Reviews"})})]})}),function(e,t){switch(e){case"Overview":return Object(p.jsx)(ve,{film:t});case"Details":return Object(p.jsx)(Oe,{film:t});case"Reviews":return Object(p.jsx)(xe,{comments:a})}}(u,e)]})]})})]}),Object(p.jsxs)("div",{className:"page-content",children:[Object(p.jsxs)("section",{className:"catalog catalog--like-this",children:[Object(p.jsx)("h2",{className:"catalog__title",children:"More like this"}),Object(p.jsx)(y,{films:c,isSimilarFilm:!0})]}),Object(p.jsx)(g,{})]})]})};var ge=function(){var e=Object(h.c)(ue);return Object(p.jsxs)("div",{className:"user-page",children:[Object(p.jsx)(re,{isMyList:!0,isSignIn:!1,headerTitle:"user-page__head"}),Object(p.jsxs)("section",{className:"catalog",children:[Object(p.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(p.jsx)("div",{className:"catalog__films-list",children:e.map((function(e){return Object(p.jsx)(w,{film:e,isSimilarFilm:!1},e.id)}))})]}),Object(p.jsx)(g,{})]})};var Ne=function(){return Object(p.jsx)("p",{children:"Loading ..."})};var we=function(){var e=Object(h.c)(se),t=Object(v.h)().movieId,a=e.find((function(e){return e.id===parseInt(t,10)})),c=Object(n.useRef)(null),i=Object(v.g)(),r=Object(n.useState)(!0),s=Object(x.a)(r,2),l=s[0],o=s[1],d=Object(n.useState)("00:00"),u=Object(x.a)(d,2),j=u[0],m=u[1],b=Object(n.useState)("0"),f=Object(x.a)(b,2),_=f[0],O=f[1],g=Object(n.useState)(Boolean),N=Object(x.a)(g,2),w=N[0],y=N[1],k=function(e,t){var a=new Date(0,0,0,0,0,e-t),c=a.getHours(),n=a.getMinutes(),i=a.getSeconds();return(c>0?[c,n,i]:[n,i]).map((function(e){return e<10?"0".concat(e):"".concat(e)})).join(":")};Object(n.useEffect)((function(){var e=c.current;return e&&(e.onloadeddata=function(){var t=k(e.duration,0);m(t),y(!1)},e.ontimeupdate=function(){var t=k(e.duration,e.currentTime);if(m(t),0!==e.currentTime){var a=e.currentTime/e.duration*100;O(String(a))}}),function(){e&&(e.ontimeupdate=null)}}),[c]);var S=Object(n.useCallback)((function(e){e.preventDefault(),c.current&&c.current.paused?c.current.play():c.current&&!c.current.paused&&c.current.pause()}),[]);return w?Object(p.jsx)(Ne,{}):Object(p.jsxs)("div",{className:"player",children:[Object(p.jsx)("video",{src:null===a||void 0===a?void 0:a.video_link,className:"player__video",poster:null===a||void 0===a?void 0:a.preview_image,ref:c,onPlay:function(){return c.current?o(c.current.paused):""},onPause:function(){return c.current?o(c.current.paused):""}}),Object(p.jsx)("button",{type:"button",className:"player__exit",onClick:function(){return i.push("/films/".concat(null===a||void 0===a?void 0:a.id))},children:"Exit"}),Object(p.jsxs)("div",{className:"player__controls",children:[Object(p.jsxs)("div",{className:"player__controls-row",children:[Object(p.jsxs)("div",{className:"player__time",children:[Object(p.jsx)("progress",{className:"player__progress",value:_,max:"100"}),Object(p.jsx)("div",{className:"player__toggler",style:{left:"".concat(_,"%")},children:"Toggler"})]}),Object(p.jsx)("div",{className:"player__time-value",children:"-".concat(j)})]}),Object(p.jsxs)("div",{className:"player__controls-row",children:[Object(p.jsxs)("button",{type:"button",className:"player__play",onClick:S,children:[Object(p.jsxs)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:[Object(p.jsx)("use",{href:"#".concat(l?"play-s":"pause")}),";"]}),Object(p.jsx)("span",{children:"Play"})]}),Object(p.jsx)("div",{className:"player__name",children:"Transpotting"}),Object(p.jsxs)("button",{type:"button",className:"player__full-screen",onClick:function(){var e;null===(e=c.current)||void 0===e||e.requestFullscreen()},children:[Object(p.jsx)("svg",{viewBox:"0 0 27 27",width:"27",height:"27",children:Object(p.jsx)("use",{href:"#full-screen"})}),Object(p.jsx)("span",{children:"Full screen"})]})]})]})]})};var ye=function(){var e=Object(h.b)(),t=function(t){e(function(e){var t=e.email,a=e.password;return function(){var e=Object(ee.a)($.a.mark((function e(c,n,i){var r,s,l,o;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.post(b.Login,{email:t,password:a});case 2:return r=e.sent,s=r.data.token,u(s),c(I(m.Auth)),e.next=8,i.get(b.Login);case 8:l=e.sent,o=l.data.avatar_url,c(R(o));case 11:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()}(t))},a=Object(v.g)(),c=Object(n.useRef)(null),i=Object(n.useRef)(null),r=/[0-9]{1,}[a-zA-Z]{1,}|[a-zA-Z]{1,}[0-9]{1,}/;return Object(p.jsxs)("div",{className:"user-page",children:[Object(p.jsx)(re,{isMyList:!1,isSignIn:!0,headerTitle:"user-page__head"}),Object(p.jsx)("div",{className:"sign-in user-page__content",children:Object(p.jsxs)("form",{action:"#",className:"sign-in__form",onSubmit:function(e){e.preventDefault(),i.current&&c.current&&(r.test(i.current.value)?(t({email:c.current.value,password:i.current.value}),a.push(j.Root)):(i.current.setCustomValidity("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0438\u0437 \u043e\u0434\u043d\u043e\u0439 \u0431\u0443\u043a\u0432\u044b \u0438 \u0446\u0438\u0444\u0440\u044b."),i.current.reportValidity()))},children:[Object(p.jsxs)("div",{className:"sign-in__fields",children:[Object(p.jsxs)("div",{className:"sign-in__field",children:[Object(p.jsx)("input",{className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email",ref:c}),Object(p.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(p.jsxs)("div",{className:"sign-in__field",children:[Object(p.jsx)("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",ref:i,onChange:function(e){r.test(e.target.value)&&(e.target.setCustomValidity(""),e.target.reportValidity())}}),Object(p.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(p.jsx)("div",{className:"sign-in__submit",children:Object(p.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(p.jsx)(g,{})]})};var ke=function(){return Object(p.jsxs)("section",{className:"game__screen",children:[Object(p.jsx)("h1",{children:"404. Page not found"}),Object(p.jsx)(_.b,{to:"/",children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})]})};var Se=function(e){var t=e.exact,a=e.path,c=e.render,n=Object(h.c)(K);return Object(p.jsx)(v.b,{exact:t,path:a,render:function(){return n===m.Auth?c():Object(p.jsx)(v.a,{to:j.SignIn})}})};var Ce=function(){var e=Object(h.c)(K),t=Object(h.c)(Q);return function(e){return e===m.Unknown}(e)||!t?Object(p.jsx)(Ne,{}):Object(p.jsx)(_.a,{children:Object(p.jsxs)(v.d,{children:[Object(p.jsx)(v.b,{exact:!0,path:j.Root,component:be}),Object(p.jsx)(Se,{exact:!0,path:j.MyList,render:function(){return Object(p.jsx)(ge,{})}}),Object(p.jsx)(Se,{exact:!0,path:j.AddReview,render:function(){return Object(p.jsx)(_e,{})}}),Object(p.jsx)(v.b,{exact:!0,path:j.MoviePage,component:pe}),Object(p.jsx)(v.b,{exact:!0,path:j.Player,component:we}),Object(p.jsx)(v.b,{exact:!0,path:j.SignIn,component:ye}),Object(p.jsx)(v.b,{children:Object(p.jsx)(ke,{})})]})})},Fe=function(e){var t=o.a.create({baseURL:"https://8.react.pages.academy/wtw",timeout:5e3});return t.interceptors.response.use((function(e){return e}),(function(t){var a=t.response;return(null===a||void 0===a?void 0:a.status)===c.Unauthorized&&e(),Promise.reject(t)})),t.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(d);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),t}((function(){return Le.dispatch(I(m.NoAuth))})),Le=Object(f.a)({reducer:Z,middleware:function(e){return e({thunk:{extraArgument:Fe}})}});Le.dispatch(function(){var e=Object(ee.a)($.a.mark((function e(t,a,c){var n,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get(b.Login);case 3:n=e.sent,i=n.data.avatar_url,t(R(i)),t(I(m.Auth)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t(I(m.NoAuth));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,c){return e.apply(this,arguments)}}()),Le.dispatch(function(){var e=Object(ee.a)($.a.mark((function e(t,a,c){var n,i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(b.Films);case 2:n=e.sent,i=n.data,t(F(i));case 5:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()),Le.dispatch(ae()),s.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(h.a,{store:Le,children:Object(p.jsx)(Ce,{})})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.d7825919.chunk.js.map